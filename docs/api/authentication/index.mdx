---
sidebar_position: 1
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Authentication

ETHGas API uses Bearer token authentication.

## Overview

Authentication involves:

1. Login – obtain tokens
2. Verify – check token validity
3. Refresh – rotate tokens
4. Logout – invalidate session

## Authentication Flow

<div className="auth-flow-container">

```mermaid
sequenceDiagram
    participant C as 🔐 Client Application
    participant A as ⚡ ETHGas API
    
    Note over C,A: 🚀 Authentication Process
    
    C->>+A: 1️⃣ POST /v1/user/login
    Note right of A: Generate EIP712 message
    A-->>-C: 📋 EIP712 message + nonce
    
    Note over C: 🖋️ User signs message
    
    C->>+A: 2️⃣ POST /v1/user/login/verify
    Note right of A: Verify signature
    A-->>-C: ✅ access_token + refresh_token
    
    Note over C,A: 🔄 Token Management
    
    loop API Requests
        C->>A: 🔑 Authenticated requests
        A-->>C: 📊 Response data
    end
    
    Note over C,A: ⏰ When token expires
    
    C->>+A: 3️⃣ POST /v1/user/login/refresh
    A-->>-C: 🔄 New access_token
    
    Note over C,A: 🏁 Session End
    
    C->>+A: 4️⃣ POST /v1/user/logout
    A-->>-C: ✋ Session invalidated
```

</div>

<div className="auth-steps">
  <div className="step-item">
    <div className="step-circle">1</div>
    <div className="step-content">
      <strong>Initial Login</strong><br/>
      Send wallet address to get EIP712 message for signing
    </div>
  </div>
  
  <div className="step-item">
    <div className="step-circle">2</div>
    <div className="step-content">
      <strong>Verify Signature</strong><br/>
      Submit signed message to receive access and refresh tokens
    </div>
  </div>
  
  <div className="step-item">
    <div className="step-circle">3</div>
    <div className="step-content">
      <strong>Token Refresh</strong><br/>
      Use refresh token to get new access token when expired
    </div>
  </div>
  
  <div className="step-item">
    <div className="step-circle">4</div>
    <div className="step-content">
      <strong>Logout</strong><br/>
      Invalidate session and clear all tokens securely
    </div>
  </div>
</div>

## API Endpoints

<div className="api-endpoints-grid">

<details className="api-endpoint">
<summary className="api-endpoint-header">
  <span className="api-method-post">**POST**</span> `/v1/user/login` - Login with user address and optional display name
</summary>

**Code Example:**
<Tabs>
<TabItem value="http" label="HTTP" default>

```bash
curl -X POST /v1/user/login?addr=0x8F02425B5f3c522b7EF8EA124162645F0397c478&name=username
```

</TabItem>
<TabItem value="python" label="Python">

```python
import requests

url = "https://mainnet.app.ethgas.com/api/v1/user/login"

payload = {
    'addr': '0x8F02425B5f3c522b7EF8EA124162645F0397c478',
    'name': 'username'
}

headers = {
  'Content-Type': 'application/json'
}

response = requests.post(url, headers=headers, params=payload)
print(response.text)
```

</TabItem>
</Tabs>

**Request Parameters:**

| Parameter | Required | Type | Description |
|-----------|----------|------|-------------|
| `addr` | YES | string | User's EOA account (account) address |
| `name` | NO | string | Display name |

**Response Example:**

```json
{
    "success": true,
    "data": {
        "status": "verify",
        "eip712Message": "{\"types\":{\"EIP712Domain\":[{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"version\",\"type\":\"string\"},{\"name\":\"chainId\",\"type\":\"uint256\"},{\"name\":\"verifyingContract\",\"type\":\"address\"}],\"data\":[{\"name\":\"hash\",\"type\":\"string\"},{\"name\":\"message\",\"type\":\"string\"},{\"name\":\"domain\",\"type\":\"string\"}]},\"primaryType\":\"data\",\"message\":{\"hash\":\"52a90c73\",\"message\":\"Please sign this message to verify account ownership\",\"domain\":\"ethgas.com\"},\"domain\":{\"name\":\"ETHGas Login\",\"version\":\"1\",\"chainId\":32382,\"verifyingContract\":\"0x0000000000000000000000000000000000000000\"}}",
        "nonceHash": "52a90c73"
    }
}
```

**Response Body:**

| Name | Type | Description |
|------|------|-------------|
| `status` | string | Login status |
| `eip712Message` | object | EIP712 message for signing |
| `nonceHash` | string | Unique nonce to identify this login request |

</details>

<details className="api-endpoint">
<summary className="api-endpoint-header">
  <span className="api-method-post">**POST**</span> `/v1/user/login/verify` - Verify login with signed EIP712 message
</summary>

**Code Example:**
<Tabs>
<TabItem value="http" label="HTTP" default>

```bash
curl -X POST /v1/user/login/verify?addr=0x8F02425B5f3c522b7EF8EA124162645F0397c478&nonceHash=0x1234567890abcdef...&signature=0xabcdef123456...
```

</TabItem>
<TabItem value="python" label="Python">

```python
import requests

url = "https://mainnet.app.ethgas.com/api/v1/user/login/verify"

payload = {
    'addr': '0x8F02425B5f3c522b7EF8EA124162645F0397c478',
    'nonceHash': '0x1234567890abcdef...',
    'signature': '0xabcdef123456...'
}

headers = {
  'Content-Type': 'application/json'
}

response = requests.post(url, headers=headers, params=payload)
print(response.text)
```

</TabItem>
</Tabs>

**Request Parameters:**

| Parameter | Required | Type | Description |
|-----------|----------|------|-------------|
| `addr` | YES | string | User's EOA account address |
| `nonceHash` | YES | string | Nonce hash from login response |
| `signature` | YES | string | Signed EIP712 message |

**Response Example:**

```json
{
    "success": true,
    "data": {
        "accessToken": "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9...",
        "refreshToken": "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9...",
        "expiresIn": 3600
    }
}
```

</details>

<details className="api-endpoint">
<summary className="api-endpoint-header">
  <span className="api-method-post">**POST**</span> `/v1/user/login/refresh` - Refresh access token using refresh token
</summary>

**Code Example:**
<Tabs>
<TabItem value="http" label="HTTP" default>

```bash
curl -H "Authorization: Bearer {{access_token}}" -X POST /api/v1/user/login/refresh?refreshToken=eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InVzZXJJZCI6MzEsImFkZHJlc3MiOiIweDVjODEyYzlhNjdlNjkwMGViMjBmM2YzMWQwZWNjZTUyM2Q2YTVjMDMiLCJyb2xlcyI6WyJST0xFX1VTRVIiXX0sImFjY2Vzc190eXBlIjoicmVmcmVzaF90b2tlbiIsImlhdCI6MTY5NzQyNDM0MCwiZXhwIjoxNjk4MDI5MTQwfQ.Y5dtx_VXGDZ4EDt4e6qtaVd811XumXjtDtVMiQeibNCai5zvV1PJJ3R8WCTSZb6NbbxAtFsTglYRD10aigDECA
```

</TabItem>
<TabItem value="python" label="Python">

```python
import requests

url = "https://mainnet.app.ethgas.com/api/v1/user/login/refresh"

payload = {
    'refreshToken': 'eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InVzZXJJZCI6MzEsImFkZHJlc3MiOiIweDVjODEyYzlhNjdlNjkwMGViMjBmM2YzMWQwZWNjZTUyM2Q2YTVjMDMiLCJyb2xlcyI6WyJST0xFX1VTRVIiXX0sImFjY2Vzc190eXBlIjoicmVmcmVzaF90b2tlbiIsImlhdCI6MTY5NzQyNDM0MCwiZXhwIjoxNjk4MDI5MTQwfQ.Y5dtx_VXGDZ4EDt4e6qtaVd811XumXjtDtVMiQeibNCai5zvV1PJJ3R8WCTSZb6NbbxAtFsTglYRD10aigDECA'
}

headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InVzZXJJZCI6MzEsImFkZHJlc3MiOiIweDVjODEyYzlhNjdlNjkwMGViMjBmM2YzMWQwZWNjZTUyM2Q2YTVjMDMiLCJyb2xlcyI6WyJST0xFX1VTRVIiXX0sImFjY2Vzc190eXBlIjoiYWNjZXNzX3Rva2VuIiwiaWF0IjoxNjk3NDQ1MjQyLCJleHAiOjE2OTc0NDg4NDJ9.iPUK1f8QWZLnKPt-fdo-dlrakxSPyo041J5xnIKVLtsOsBIR8gu2hEv8a7S18CtRfViRchT4xhSQfSJj-SxleQ'
}

response = requests.post(url, headers=headers, params=payload)
print(response.text)
```

</TabItem>
</Tabs>

**Request Parameters:**

| Parameter | Required | Type | Description |
|-----------|----------|------|-------------|
| `refreshToken` | YES | string | Valid refresh token |

**Response Example:**

```json
{
    "success": true,
    "data": {
        "accessToken": "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9...",
        "refreshToken": "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9...",
        "expiresIn": 3600
    }
}
```

</details>

<details className="api-endpoint">
<summary className="api-endpoint-header">
  <span className="api-method-post">**POST**</span> `/v1/user/logout` - Logout and invalidate session
</summary>

**Code Example:**
<Tabs>
<TabItem value="http" label="HTTP" default>

```bash
curl -H "Authorization: Bearer {{access_token}}" -X POST /v1/user/logout
```

</TabItem>
<TabItem value="python" label="Python">

```python
import requests

url = "https://mainnet.app.ethgas.com/api/v1/user/logout"

headers = {
    'Authorization': 'Bearer <your-access-token>',
    'Content-Type': 'application/json'
}

response = requests.post(url, headers=headers)
print(response.text)
```

</TabItem>
</Tabs>

**Request Parameters:**

No parameters required.

**Response Example:**

```json
{
    "success": true,
    "message": "Logged out successfully"
}
```

</details>

</div>

## Best Practices

- [x] **Store tokens securely** - Keep access tokens in secure storage and never expose them in client-side code
- [x] **Refresh proactively** - Refresh tokens before they expire to maintain continuous access
- [x] **Handle errors gracefully** - Implement proper error handling for authentication failures
- [x] **Logout when done** - Always logout to invalidate sessions and clear tokens 