---
sidebar_position: 1
---

# WebSocket

WEBSOCKET

## Path

`/ws`

The websocket channel provides access of streaming data subscriptions and queries on public/private data.

<details>
<summary>Sample Python Script</summary>

```python
import json

import websocket
from websocket import WebSocket

__ws_url = "wss://mainnet.app.ethgas.com/ws"


def on_open(ws: WebSocket):
    message = {
        "op": "subscribe",
        "args": [
            {
                "channel": "orderBookUpdate",
                "marketType": "wholeBlock"
            }
        ]
    }
    ws.send(json.dumps(message))


def on_message(ws: WebSocket, message: str):
    print(f"Received message: {message}")


def on_error(ws: WebSocket, error: Exception):
    print(f"Error: {error}")


def on_close(ws: WebSocket, close_status_code: int, close_msg: str):
    print("WebSocket closed")


if __name__ == "__main__":
    ws_app = websocket.WebSocketApp(
        __ws_url,
        on_open=on_open,
        on_message=on_message,
        on_close=on_close,
        on_error=on_error,
    )
    ws_app.run_forever()
```

</details>

## Quick Navigation

- [Connection Information](#connection-information) - WebSocket URLs and authentication
- [Message Structure](#message-structure) - Request/response format and commands  
- [Channel Types](#channel-types) - Public and private channel overview
- [Public Channels](#public-channels-examples) - Market data and trading updates
- [Private Channels](#private-channels-examples) - Account-specific data
- [WebSocket Query](#websocket-query) - On-demand data requests


## Connection Information {#connection-information}

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs>
<TabItem value="mainnet" label="MainNet" default>

**WebSocket URL**: `wss://mainnet.app.ethgas.com/ws`

</TabItem>
<TabItem value="testnet-hoodi" label="TestNet (Hoodi)">

**WebSocket URL**: `wss://hoodi.app.ethgas.com/ws`

</TabItem>
<TabItem value="testnet-private" label="TestNet (Private Chain)">

**WebSocket URL**: `wss://testchain.app.ethgas.com/ws`

</TabItem>
</Tabs>

### Connection Requirements

- **Protocol**: WebSocket (WSS)
- **Authentication**: Required for private channels
- **Rate Limiting**: Applied to prevent abuse

> A private websocket session needs to include the access token in the session header, format: 'Bearer accessToken'

## Message Structure {#message-structure}

### Request

| Field | Required | Type | Description |
| --- | --- | --- | --- |
| op | YES | string | operation type |
| args | YES | object[] | list of operation arguments |

### Response (generic)

| Field | Type | Description |
| --- | --- | --- |
| e | string | Event type |
| E | integer | Event timestamp |
| s | string | Instrument ID |
| P | object | Data of corresponding event type |

## Commands

### Authentication

- `login`
- `logout`

### Subscription

- `subscribe`
- `unsubscribe`

### Query

- `query`

## Channel Types {#channel-types}

### Public Channels
Real-time market data available to all users:

- Preconf Market Update
- Candlestick Update  
- Recent Trades Update
- Order Book Update
- Ticker Update
- Inclusion Preconf Top Sales
- Block Builder Update

### Private Channels
User-specific data requiring authentication:

- Account Order Update
- Account Transaction Update
- Account Position Update
- Preconf Bundle Update

## Error Handling {#error-handling}

For all error codes and handling guidance (WebSocket and REST), see the Error Codes Reference:

- [Error Codes](/docs/reference/error-codes#websocket-errors)

| Error Code | Description |
|------------|-------------|
| 1001 | Authentication failed |
| 1002 | Invalid channel |
| 1003 | Rate limit exceeded |
| 1004 | Connection timeout |

<!-- ## References

- WebSocket section: This documentation  -->



## Public Channels

### Preconf Market Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`preconfMarketUpdate` - Real-time preconfirmation market data updates
</summary>

**Example Request:**

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "preconfMarketUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

**Example Response:**

```json
{
    "e": "preconfMarketUpdate",
    "E": 1744684899022,
    "s": "ETH-PC-603410",
    "a": "NewEpoch",
    "P": {
        "m": 1000000603410,
        "T": "inclusionPreconf",
        "s": 603410,
        "i": "ETH-PC-603410",
        "n": "Eth Preconf Inclusion Slot #603410",
        "M": 1744685494000,
        "f": 1744686266000,
        "b": 1744685498000,
        "q": "1",
        "mQ": "1",
        "MQ": "36000000",
        "PS": "0.00000000001",
        "mP": "0.00000000001",
        "MP": "0.00001",
        "C": "3.99996",
        "A": 36000000,
        "r": 0,
        "S": 0,
        "e": 1,
        "a": 1744685496000,
        "c": 1744684899000,
        "u": 1744684899000,
        "tp": 36000000
    }
}
```

**Request Parameters:**

| Name | Type | Description |
| --- | --- | --- |
| op | string | Operation type (subscribe) |
| args | object | Arguments |
| └ channel | string | Channel name (preconfMarketUpdate) |
| └ marketType | string | Market type (inclusionPreconf) |

</details>

### Candlestick Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`candlestickUpdate` - Real-time candlestick/OHLC data updates
</summary>

**Example Request:**

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "candlestickUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

**Example Response:**

```json
{
    "e": "candlestickUpdate",
    "E": 1736742241012,
    "s": "ETH-PC-117",
    "P": {
        "I": "ETH-PC-117",
        "m": 1000000000117,
        "t": 1736742240000,
        "i": 1000,
        "o": "0",
        "h": "0",
        "l": "0",
        "c": "0",
        "v": "0",
        "F": true
    }
}
```

**Request Parameters:**

| Name | Type | Description |
| --- | --- | --- |
| op | string | Operation type (subscribe) |
| args | object | Arguments |
| └ channel | string | Channel name (candlestickUpdate) |
| └ marketType | string | Market type (inclusionPreconf) |

</details>

### Recent Trades Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`recentTradeUpdate` - Real-time recent trades data updates
</summary>

**Example Request:**

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "recentTradeUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

**Example Response:**

```json
{
    "e": "recentTradeUpdate",
    "E": 1739528277074,
    "s": "ETH-PC-173649",
    "P": {
        "i": "ETH-PC-173649",
        "p": "0.00000000006",
        "q": "1702005",
        "s": true,
        "d": 1739528277070,
        "t": 683198
    }
}
```

**Request Parameters:**

| Name | Type | Description |
| --- | --- | --- |
| op | string | Operation type (subscribe) |
| args | object | Arguments |
| └ channel | string | Channel name (recentTradeUpdate) |
| └ marketType | string | Market type (inclusionPreconf) |

</details>

### Order Book Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`orderBookUpdate` - Real-time order book updates
</summary>

Example Request

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "orderBookUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

Example Response

```json
{
    "e": "orderBookUpdate",
    "E": 1736751224943,
    "s": "ETH-PC-863",
    "P": {
        "a": [],
        "b": [
            {
                "p": "0.00000000005",
                "q": "5861476"
            }
        ],
        "I": "ETH-PC-863",
        "t": 1736751224941
    }
}
```

Fields

| Name | Type | Description |
| --- | --- | --- |
| op | string | e.g. subscribe |
| args | object | Arguments |
| └ channel | string | Channel name, e.g., orderBookUpdate. |
| └ marketType | string | Market type, e.g., inclusionPreconf. |

</details>

### Ticker Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`tickerUpdate` - Real-time ticker/price updates
</summary>

Example Request

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "tickerUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

Example Response

```json
{
    "e": "tickerUpdate",
    "E": 1743667424734,
    "s": "ETH-PC-518598",
    "P": {
        "d": false,
        "p": "0.00000000002",
        "b": "0.00000000002",
        "M": "0.00000000002",
        "A": 18855242,
        "g": 17144758,
        "P": 1.0,
        "u": 1743667299000
    }
}
```

Fields

| Name | Type | Description |
| --- | --- | --- |
| op | string | e.g. subscribe |
| args | object | Arguments |
| └ channel | string | Channel name, e.g., tickerUpdate. |
| └ marketType | string | Market type, e.g., inclusionPreconf. |

</details>

### Inclusion Preconf Top Sales

<details className="api-endpoint">
<summary className="api-endpoint-header">
`inclusionPreconfSaleUpdate` - Real-time top sales updates
</summary>

Example Request

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "inclusionPreconfSaleUpdate"
        }
    ]
}
```

Example Response

```json
{
    "e": "inclusionPreconfSaleUpdate",
    "E": 1739765044256,
    "P": {
        "s": 193373,
        "g": "11288799",
        "S": [
            {
                "p": "0.0000000001",
                "q": "11078799"
            }
        ]
    }
}
```

Fields

| Name | Type | Description |
| --- | --- | --- |
| op | string | e.g. subscribe |
| args | object | Arguments |
| └ channel | string | Channel name, e.g., inclusionPreconfSaleUpdate. |

</details>

## Private Channels (Examples)

### Account Order Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`accountOrderUpdate` - Real-time account order updates
</summary>

Example Request

```json
{
    "op": "subscribe",
    "args": [
        {
             "channel": "accountOrderUpdate",
             "marketType": "inclusionPreconf",
             "pricerOnly": false
        }
    ]
}
```

Example Response

```json
{
    "e": "accountOrderUpdate",
    "E": 1742288403296,
    "s": "ETH-PC-403684",
    "P": {
        "o": 173639360,
        "c": "613ec528",
        "a": 2049,
        "C": 53,
        "t": 2,
        "i": "ETH-PC-403684",
        "m": 1000000403684,
        "p": "0.00000000001",
        "q": "3181683",
        "F": "3181683",
        "fp": "0.00003181683",
        "f": "0.0000028635147",
        "s": false,
        "P": false,
        "S": 10,
        "d": 1742288403289,
        "u": 1742288403289
    }
}
```

Fields

| Name | Type | Description |
| --- | --- | --- |
| op | string | e.g. subscribe |
| args | object | Arguments |
| └ channel | string | Channel name, e.g., accountOrderUpdate. |
| └ marketType | string | Market type, e.g., inclusionPreconf. |
| └ pricerOnly | boolean | Flag for only displaying pricer information. Optional. Default to false. |

</details>

### Account Transaction Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`accountTransactionUpdate` - Real-time account transaction updates
</summary>

**Example Request:**

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "accountTransactionUpdate",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

Example Response

```json
{
    "e": "accountTransactionUpdate",
    "E": 1742288580882,
    "s": "ETH-PC-403699",
    "P": {
        "t": 146600149,
        "i": "ETH-PC-403699",
        "o": 173651088,
        "a": 2049,
        "s": true,
        "p": "0.00000000001",
        "q": "1248972",
        "f": "0.0000011240748",
        "d": 1742288580863
    }
}
```

**Request Parameters:**

| Name | Type | Description |
| --- | --- | --- |
| op | string | Operation type (subscribe) |
| args | object | Arguments |
| └ channel | string | Channel name (accountTransactionUpdate) |
| └ marketType | string | Market type (inclusionPreconf) |

</details>

### Account Position Update

<details className="api-endpoint">
<summary className="api-endpoint-header">
`accountPositionUpdate` - Real-time account position updates
</summary>

**Example Request:**

```json
{
    "op": "subscribe",
    "args": [
        {
            "channel": "accountPositionUpdate",
            "marketType": "inclusionPreconf",
            "pricerOnly": true
        }
    ]
}
```

Example Response

```json
{
    "e": "accountPositionUpdate",
    "E": 1742288402217,
    "P": {
        "a": 2049,
        "s": 403684,
        "m": 1,
        "q": "20427356",
        "l": "0",
        "p": "0",
        "e": false,
        "b": false,
        "c": 1742288355000,
        "u": 1742288402000,
        "A": "20427356"
    }
}
```

**Request Parameters:**

| Name | Type | Description |
| --- | --- | --- |
| op | string | Operation type (subscribe) |
| args | object | Arguments |
| └ channel | string | Channel name (accountPositionUpdate) |
| └ marketType | string | Market type (inclusionPreconf) |
| └ pricerOnly | boolean | Flag for only displaying pricer information. Optional. Default to false. |

</details>

<details>
<summary>WebSocket Query (on-demand data requests)</summary>

## WebSocket Query

WebSocket queries allow you to request specific data on-demand without subscribing to continuous updates.

### Query Structure

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "queryTypeName",
            "parameter1": "value1",
            "parameter2": "value2"
        }
    ]
}
```

### Public Queries

#### Preconf Markets Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "preconfMarkets"
        }
    ]
}
```

> Example Response

```json
{
    "q": "preconfMarkets",
    "P": [
        {
            "m": 1000000603410,
            "T": "inclusionPreconf",
            "s": 603410,
            "i": "ETH-PC-603410",
            "n": "Eth Preconf Inclusion Slot #603410",
            "M": 1744685494000,
            "f": 1744686266000,
            "b": 1744685498000,
            "q": "1",
            "mQ": "1",
            "MQ": "36000000",
            "PS": "0.00000000001",
            "mP": "0.00000000001",
            "MP": "0.00001",
            "C": "3.99996",
            "A": 36000000,
            "r": 0,
            "S": 0,
            "e": 1,
            "a": 1744685496000,
            "c": 1744684899000,
            "u": 1744684899000,
            "tp": 36000000
        }
    ]
}
```

#### Order Books Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "orderBooks",
            "marketId": "ETH-PC-603410"
        }
    ]
}
```

> Example Response

```json
{
    "q": "orderBooks",
    "P": {
        "a": [
            {
                "p": "0.00000000006",
                "q": "1702005"
            }
        ],
        "b": [
            {
                "p": "0.00000000005",
                "q": "5861476"
            }
        ],
        "I": "ETH-PC-603410",
        "t": 1736751224941
    }
}
```

#### Current Slot Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "currentSlot"
        }
    ]
}
```

> Example Response

```json
{
    "q": "currentSlot",
    "P": {
        "s": 603410
    }
}
```

#### Candlesticks Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "candlesticks",
            "marketId": "ETH-PC-603410",
            "interval": 1000
        }
    ]
}
```

> Example Response

```json
{
    "q": "candlesticks",
    "P": [
        {
            "I": "ETH-PC-603410",
            "m": 1000000603410,
            "t": 1736742240000,
            "i": 1000,
            "o": "0",
            "h": "0",
            "l": "0",
            "c": "0",
            "v": "0",
            "F": true
        }
    ]
}
```

#### Recent Trades Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "recentTrades",
            "marketId": "ETH-PC-603410"
        }
    ]
}
```

> Example Response

```json
{
    "q": "recentTrades",
    "P": [
        {
            "i": "ETH-PC-603410",
            "p": "0.00000000006",
            "q": "1702005",
            "s": true,
            "d": 1739528277070,
            "t": 683198
        }
    ]
}
```

#### Inclusion Preconf Top Sales Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "inclusionPreconfTopSales"
        }
    ]
}
```

> Example Response

```json
{
    "q": "inclusionPreconfTopSales",
    "P": {
        "s": 193373,
        "g": "11288799",
        "S": [
            {
                "p": "0.0000000001",
                "q": "11078799"
            }
        ]
    }
}
```

#### Current Block Builder Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "currentBlockBuilder"
        }
    ]
}
```

> Example Response

```json
{
    "q": "currentBlockBuilder",
    "P": {
        "s": 193373,
        "b": "0x1234567890123456789012345678901234567890"
    }
}
```

### Private Queries

#### Open Orders Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "openOrders",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

> Example Response

```json
{
    "q": "openOrders",
    "P": [
        {
            "o": 173639360,
            "c": "613ec528",
            "a": 2049,
            "C": 53,
            "t": 2,
            "i": "ETH-PC-403684",
            "m": 1000000403684,
            "p": "0.00000000001",
            "q": "3181683",
            "F": "3181683",
            "fp": "0.00003181683",
            "f": "0.0000028635147",
            "s": false,
            "P": false,
            "S": 10,
            "d": 1742288403289,
            "u": 1742288403289
        }
    ]
}
```

#### Account Positions Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "accountPositions",
            "marketType": "inclusionPreconf"
        }
    ]
}
```

> Example Response

```json
{
    "q": "accountPositions",
    "P": [
        {
            "a": 2049,
            "s": 403684,
            "m": 1,
            "q": "20427356",
            "l": "0",
            "p": "0",
            "e": false,
            "b": false,
            "c": 1742288355000,
            "u": 1742288402000,
            "A": "20427356"
        }
    ]
}
```

#### Preconf Bundles Query

> Example Request

```json
{
    "op": "query",
    "args": [
        {
            "queryType": "preconfBundles",
            "slot": 123456
        }
    ]
}
```

> Example Response

```json
{
    "q": "preconfBundles",
    "P": {
        "s": 194265,
        "bu": [
            {
                "u": "c439371a-7095-4de6-82ce-6bf4fc6fd693",
                "txs": [
                    {
                        "r": false,
                        "tx": "0x02f88a827e7e82088b808477359400830334509412643b525cc34282ba84298d32bf2d094448f1c4843b9aca009b45746847617320496e636c7573696f6e20507265636f6e66732e20c080a03b39cc9c4a92f32f8d4bc88546e2655378d4e87468ba74b0d20164ed9c346838a01bdbe85274f17b2c87e4689996089affd2d7d8c542616ef7020f5975bf4ddb52",
                        "h": "0xeb1bca2f601eb124563286455544cc87a1b04b28bd5bed6fb28be81417c4a0de"
                    }
                ],
                "p": "0.00000000013"
            }
        ]
    }
}
```

</details>

